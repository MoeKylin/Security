- [暴力破解](#暴力破解)
- [凭证泄露](#凭证泄露)
- [会话混淆](#会话混淆)
- [用户凭证有效性](#用户凭证有效性)
- [邮箱弱token](#邮箱弱token)
- [重置密码token](#重置密码token)
- [接收端可篡改](#接收端可篡改)
- [Others](#others)
- [参考链接](#参考链接)

**相关链接**

- https://wooyun.kieran.top/#!/drops/494.%E5%AF%86%E7%A0%81%E6%89%BE%E5%9B%9E%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93

每个案例对应一段自己的理解和操作方式，并为涉及原理，仅做实操参考。

## 暴力破解

混淆手机号码字段爆破:

- [微信任意用户密码修改漏洞](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-011720)

修改X-Forwarded-By来源地址爆破:

- [医疗安全之医事通任意手机号注册任意密码重置（绕过多次爆破显示繁忙） ](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0216112)

## 凭证泄露

数据包返回重置链接相关凭证:

- [天天网任意账户密码重置（二）](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-058210)
- [走秀网秀团任意密码修改缺陷](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-05630)

密保泄露在页面内:

- [sohu邮箱任意用户密码重置
  ](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-04728)

数据包返回加密凭证字段(手机号/验证码):
- [新浪某站任意用户密码修改（验证码与取回逻辑设计不当）](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-085124)

## 会话混淆

创建被攻击者会话重制密码:

- [M1905电影网某重要站点任意密码重置漏洞（已入官方账号） ](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2016-0225958)
- [OPPO手机重置任意账户密码（3）](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-053349)

## 用户凭证有效性

1. OPPO手机重置任意账户密码（3）：https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-053349

使用 A 用户获取验证码，保留窗口，新建窗口使用用户 B 用户重置密码，修改手机号码与验证码为用户 A 的对应信息

2. 第二次重置OPPO手机官网任意账户密码（秒改）https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-053079

重置链接中存在用户 A 用户名与对应 Token，修改用户名为 用户 B 的用户名

3. OPPO修改任意帐号密码 https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-020032

使用用户 A 正常流程到确认修改密码时，拦截数据包，修改用户名为用户 B 的用户名

4. OPPO修改任意帐号密码-2 https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-020425

当输入用户名直接发送验证码时，拦截返回包，修改手机号为任意信息

5. OPPO修改任意帐号密码-3 https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-020532

基于 OPPO修改任意帐号密码-2，在确认修改密码时拦截返回包，修改 type 为0

## 邮箱弱token

1. 身份通任意密码修改-泄漏大量公民信息 https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-012572

用户 A 通过邮件链接重置密码附带 Token，修改用户名为用户 B 的用户名

重置链接为Unix时间戳: [奇虎360任意用户密码修改漏洞](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2012-08333)

重置链接为普通时间戳: [中兴某网站任意用户密码重置漏洞（经典设计缺陷案例）](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-090226)

## 重置密码token

1. 魅族的账号系统内存在漏洞可导致任意账户的密码重置 https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2014-078208

使用用户 A 提交

## 接收端可篡改

重置凭证接收端未绑定用户+确认修改密码时未绑定用户: [OPPO官网用户密码重置等漏洞大礼包一个5）任意用户密码重置（二）](https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2013-019649)

## Others

- 应数据包 JSON 内标识状态为 True
- 重置密码链接的 token/username

## 参考链接

- 乌云网案例
